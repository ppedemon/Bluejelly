module Contrived

#
# Weird and contrived tests
#

data Nil{0,0}
data Cons{1,2}

extern bluejelly.Int.add{2}, bluejelly.Int.neg{1}

fun add x y = bluejelly.Int.add x y
fun neg x = bluejelly.Int.neg x

fun noInline x y = 
  let! f =
    let! k = id const in 
    let! n = neg 1 in 
    third n n k 1 
  in
  let v = bluejelly.Int.add x y in
  let w = Cons 1 Nil in 
  f v w

fun testNoInline = noInline 3 4

fun id x = x
fun const x y = x
fun third w x y z = y
